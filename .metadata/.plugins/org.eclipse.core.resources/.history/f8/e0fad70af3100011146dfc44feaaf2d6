package screens;

import java.awt.Color;
import java.awt.EventQueue;
import java.awt.Toolkit;

import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.SwingConstants;

public class StartScreen extends JFrame {
    private static final long serialVersionUID = 1L;

    private JPanel contentPane;
    private JLabel lblNewLabel;
    private JButton btnNewButton2; // Botón nave (normal)
    private JButton btnNewButton3; // Botón nave negra (flash visual)

    public static void main(String[] args) {
        EventQueue.invokeLater(() -> {
            try {
                StartScreen frame = new StartScreen();
                frame.setVisible(true);
            } catch (Exception e) {
                e.printStackTrace();
            }
        });
    }

    public StartScreen() {
        setBackground(new Color(0, 0, 0));
        setResizable(false);
        setIconImage(Toolkit.getDefaultToolkit().getImage(StartScreen.class.getResource("/img/SPACEINVADERSFONDO.png")));
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setBounds(100, 100, 700, 471);

        contentPane = new JPanel();
        contentPane.setBorder(null);
        contentPane.setLayout(null);
        setContentPane(contentPane);

        // Fondo, botón normal y botón negro superpuesto
        contentPane.add(getLblNewLabel());
        contentPane.add(getbtnNewButton2());
        contentPane.add(getbtnNewButton3());

        // Asegurar que el negro quede POR ENCIMA del normal y del fondo
        contentPane.setComponentZOrder(getbtnNewButton3(), 0);
        contentPane.setComponentZOrder(getbtnNewButton2(), 1);
        contentPane.setComponentZOrder(getLblNewLabel(), 2);

        // Por defecto, el negro está oculto
        getbtnNewButton3().setVisible(false);

        // Acción: clic en el botón 2
        getbtnNewButton2().addActionListener(e -> {
            // 1) Mostrar el negro superpuesto
            btnNewButton3.setVisible(true);
            // 2) Pintarlo YA para que se vea el flash (sin Timer)
            btnNewButton3.paintImmediately(0, 0, btnNewButton3.getWidth(), btnNewButton3.getHeight());

            // 3) Pausa mínima opcional para que se perciba el “flash” (sin Timer)
            //    Si quieres cero pausa, comenta estas 3 líneas.
            try {
                Thread.sleep(120); // ~120 ms
            } catch (InterruptedException ex) {
                Thread.currentThread().interrupt();
            }

            // 4) Ocultar el negro y abrir el juego
            btnNewButton3.setVisible(false);

            GameScreen game = new GameScreen();
            game.setVisible(true);
            dispose();
        });

        // (Opcional) si alguien clicara sobre el negro, replicamos el comportamiento,
        // pero lo dejamos deshabilitado para que sea puramente visual.
        getbtnNewButton3().setEnabled(false);
        getbtnNewButton3().addActionListener(e -> getbtnNewButton2().doClick());

        setLocationRelativeTo(null); // Centrar ventana
    }

    // ====== Componentes ======

    // Label de fondo
    private JLabel getLblNewLabel() {
        if (lblNewLabel == null) {
            lblNewLabel = new JLabel("fondillo");
            lblNewLabel.setBounds(0, 0, 694, 442);
            lblNewLabel.setIcon(new ImageIcon(StartScreen.class.getResource("/img/pantallastart.png")));
            lblNewLabel.setHorizontalAlignment(SwingConstants.CENTER);
        }
        return lblNewLabel;
    }

    // Botón de la nave (normal)
    private JButton getbtnNewButton2() {
        if (btnNewButton2 == null) {
            ImageIcon icon = new ImageIcon(getClass().getResource("/img/nave.png"));
            btnNewButton2 = new JButton(icon);
            btnNewButton2.setBounds(288, 236, 106, 85);
            btnNewButton2.setRolloverIcon(icon);
            btnNewButton2.setPressedIcon(icon);
            btnNewButton2.setContentAreaFilled(false);
            btnNewButton2.setBorderPainted(false);
            btnNewButton2.setFocusPainted(false);
            btnNewButton2.setOpaque(false);
            btnNewButton2.setText(null);
        }
        return btnNewButton2;
    }

    // Botón de la nave negra (solo para el flash visual)
    private JButton getbtnNewButton3() {
        if (btnNewButton3 == null) {
            ImageIcon icon = new ImageIcon(getClass().getResource("/img/naveparaparpadeo.png"));
            btnNewButton3 = new JButton(icon);
            btnNewButton3.setBounds(288, 236, 106, 85);
            btnNewButton3.setRolloverIcon(icon);
            btnNewButton3.setPressedIcon(icon);
            btnNewButton3.setContentAreaFilled(false);
            btnNewButton3.setBorderPainted(false);
            btnNewButton3.setFocusPainted(false);
            btnNewButton3.setOpaque(false);
            btnNewButton3.setText(null);
            btnNewButton3.setVisible(false); // arranca oculto
        }
        return btnNewButton3;
    }
}